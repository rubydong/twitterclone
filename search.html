<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="materialize/css/materialize.css">
        <link rel="stylesheet" type="text/css" href="style.css">
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    </head>
    
    <body style="margin-top: 2%;">
         <form method="POST" action="/search" id="searchForm">
            <h1>Search</h1> <p>
            
             <div class="formContent">
                <input type="text" name="timestamp" placeholder="Timestamp">
                <input type="text" name="limit" placeholder="Limit">
                <button type="submit" class="btn btn-default" style="margin-top: 10px">Submit</button>
            </div>
             
             <table id="searchTable">
             </table>
             
             <div id = "errorMsg"></div>
        </form>
        
    
        <script>    
            
            $(document).ready(function () {
                $("#searchForm").submit(function (event, jqXHR) {
                    event.preventDefault(); 
                    $.ajax({
                        "url": "/search",
                        "type":"POST",
                        "data": JSON.stringify({
                            timestamp: $("input[name='timestamp'").val(), 
                            limit: $("input[name='limit']").val()
                        }), 
                        "dataType": "json", 
                        "contentType": "application/json; charset=utf-8"
                    }).done(function(data) {
                        
                        if (data.status == "OK"){
                            var parsed = data;
                            $("#searchTable").append("<tr> <th>Tweet Id</th><th>Username</th> <th>Content</th><th>Timestamp</th> </tr>");

                            for (var i = 0; i < parsed.items.length; i++) {
                                $("#searchTable").append("<tr><td>" + parsed.items[i].id + "</td><td> " + parsed.items[i].username + "</td><td> " + parsed.items[i].content + "</td><td>"+ parsed.items[i].timestamp + "</td></tr>");
                            }
                        } else {
                            $("#errorMsg").html("Please log in first");
                        }
                    });

                });
            });

                 
            
        </script>
    </body>
</html>