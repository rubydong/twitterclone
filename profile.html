<!DOCTYPE html>
<html>
    <head>
        
        <link rel="stylesheet" type="text/css" href="materialize/css/materialize.css">
        <link rel="stylesheet" type="text/css" href="style.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    </head>
    <body>
        <div id="navigation">
            <!- -->
            <button type="submit" class= "btn btn-default" onclick ="window.location='/'">Home</button>
            <button type="submit" class= "btn btn-default" onclick ="window.location='/profile'">Profile</button>
            <button type="submit" class="btn btn-default" onclick="window.location='/search'">Search</button>
            <button type="submit" class="btn btn-default" onclick ="window.location='/logout'">Logout</button>    
        </div>
        
        <div id="userInfo">
            <h2>Twitter</h2>
            <img src="img/cat.jpg" width="200px"> <br>
            <div id="info"> </div>
        </div>
        
        <div id="tweetsInfo">
            <div id="newsfeed"></div>
        </div>
        
        <script>

            $(document).ready(function () {
                $.ajax ({
                    "url": "/profile",
                    "type": "POST"
       
                }).done(function (data) {
                    if (data.status == "OK") {
                        var tweetsArr = data.items;
                        for (var i = 0; i < tweetsArr.length; i++) {
                            var timestamp = tweetsArr[i].timestamp;
                            var date = new Date (timestamp);
                            var date = (date.getMonth()+1) + "/" +  date.getDate() + "/" + date.getFullYear();
                            
                            $("#newsfeed").prepend("<div class='tweet'> Id #" + tweetsArr[i].id + " @" + tweetsArr[i].username + " " + date + " unix [" + timestamp + "]<br>" + tweetsArr[i].content + "</div>");
                        }
                    } else {
                        window.location = "/login";
                    }
                });
                
                $.ajax ({
                    "url": "/user", 
                    "type": "POST"
                }).done(function (data) {
                    if (data.status == "OK") {
                        $("#info").append("@" + data.user.username + "<br>" + "Email: " +data.user.email + "<br>"  + data.user.followers + " followers<br>" + data.user.following + " following"); 
                        //alert(JSON.stringify(data));
                    } else {
                         //alert(JSON.stringify(data.error));
                    }
                });
                
                
            });
    
        </script>
    </body>
</html>

